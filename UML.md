- personal (magico)
      - AFECTAN: app_personal, app_inges, app_colaboradores_produccion/admin/rrhh/compras
      - SUSCRIBEN: 
  - uid (como key):
    - areas:
      - proyectos: boolean
      - produccion: boolean
      - compras: boolean
      - administracion: boolean
      - rrhh: bool
    - uid: uid
    - nombre: string
    - nickname: ? string
    - email: string
- administracion:
   - centro de costos
      - familia(nombre)
         - nombre
         - clave (definir!)
         - years
            - 2019: total (en float)
            - 2020: total (en float)
            - etc
         - children:
            - cuenta (por nombre)
               - nombre
               - clave
               - total_cuenta (si no es hoja es suma)
               - ppto_cuenta (si no es hoja es suma)
               - forma_pago (GR, MIX, NA o (se me olvidó la ultima)) (si no es hoja es suma (O sea si solo un tipo en hojas ese, si hay mas entonces MIX))
               - formato_fecha ("diario", "semanal", "quincenal", "mensual", "anual") (Hay que definir con lo del formato)
               - areas_lectura: (si no es hoja es suma)
                  - *todas las áreas que tienen acceso a esta cuenta, en bool
               - areas_edicion: (si no es hoja es suma)
                  - *todas las áreas que tienen acceso a esta cuenta, en bool
               - children: "" si es hoja, si es nodo repite el formato json
               - REGISTROS EN RAMA APARTE
               - registros (si no es hoja NO puede existir, Hay que redistribuirlos a las hojas)
                  - year (por numero)
                     - total_year
                     - semanas ???? O mensual? o que dependa del formato?? Hay que definir
                        - semana (por numero)???
                           - total_semana???
                           - registro (por uid)
                              - monto
                              - timestamps
                                 - ingreso (cuando se hace el registro)
                                    - user: (username de quien lo hace)
                                    - fecha (timestamp)
                                 - fecha (de cuando es el valor)
                                 - modificaciones:
                                    - por push
                                       - user: uid
                                       - fecha: timestamp
                              - concepto
                              - cantidad //para compras? :/
                              - clave_concepto //para compras? :/
- categorias:
   - categoria (por nombre)
      - nombre
      - clave
- obras (magico)
   - AFECTAN: app_obra app_obras_prod app_procesos
   - SUSCRIBEN: app_procesos app_asistencia app_desplegar_procesos app_kaizen_global app_presupuesto
   - obra: (por nombre)
      - nombre
      - cliente
      - clave
      - num_procesos
      - utilidad_semanal
      - PPR: ($)(Personal de producción de reserva)
      - supervisor 
         - supervisor (por id)
            - nombre
            - activo: bool
      - procesos:
         - proceso (por clave):
            - nombre
            - alcance
            - clave
            - tipo: "adicional"/"continuo"/"miscelaneo"/"proyecto"
            - fechas: 
               - fecha_inicio_real
               - fecha_inicio_teorica
               - fecha_final_real
               - fecha_final_teorica
            - num_subprocesos
            - subprocesos:
               - subproceso (por clave):
                  - nombre
                  - alcance
                  - calve
                  - categoria
                  - kaizen: *
                  - fechas:
                     - igual las 4 *
            - kaizen: *
      - fechas:
         - fecha_inicio_real
         - fecha_inicio_teorica
         - fecha_final_real
         - fecha_final_teorica
      - kaizen: *
- produccion
  - diversos:
      - AFECTAN: app_diversos
      - SUSCRIBEN: app_pagos_nomina
      - viaticos
      - destajos
      - apoyo
      - reposicion
      - finiquito
      - prestamos
      - caja_chica
  - trabajadores: (no debería ir en rrhh?)
      - AFECTAN: app_trabajadores
      - SUSCRIBEN: app_asistencia
      - trabajador(por id):
         - rango
         - sueldo_base
         - jefe (nombre destajista o HEAD)
         - nombre:
            - primer_nombre
            - apellido_paterno
            - apellido_materno
         - uid
         - direccion
         - timestamps:
            - ingreso: (el último)
            - ingresos: push de todos los que ha tenido
         - obra_asignada
         - especialidad
         - activo: bool
         - nomina
            - year: (ej 2019)
               - semana: (ej 1)
                  - lunes: 
                     - obra (nombre)
                     - proceso (clave)
                     - asistencia (bool)
                  - martes:
                     - obra (nombre)
                     - proceso (clave)
                     - asistencia (bool)
                  - miercoles:
                     - obra (nombre)
                     - proceso (clave)
                     - asistencia (bool)
                   - jueves:
                     - obra (nombre)
                     - proceso (clave)
                     - asistencia (bool)
                  - viernes:
                     - obra (nombre)
                     - proceso (clave)
                     - asistencia (bool)
                  - horas_extra
                  - diversos
                     - *todos los diversos*
                  - impuestos
                  - total
  - pagos_nomina: 
      - AFECTAN: app_pagos_nomina, app_asistencia
      - SUSCRIBEN: 
      - year: (ej 2019)
         - semana: (ej 1)
            - terminada: bool
            - obra: (por nombre)
               - trabajador: (por id)
                  - nombre
                  - dias 
                     - lunes:
                        - asistencia: bool
                        - proceso: (clave) "NA" si asistencia es false
                     - martes:
                        - asistencia: bool
                        - proceso: (clave) "NA" si asistencia es false
                     - miercoles:
                        - asistencia: bool
                        - proceso: (clave) "NA" si asistencia es false
                     - jueves:
                        - asistencia: bool
                        - proceso: (clave) "NA" si asistencia es false
                     - viernes:
                        - asistencia: bool
                        - proceso: (clave) "NA" si asistencia es false
                  - horas_extra
                  - // De aquí en adelante chance no hace falta calcularlo aquí, que se guarde en trabajador los totales y el prorrateo se va a kaizen.
                  - impuestos (subtotal_esta_obra / subtotal_todas_obras_este_trabajador * pago_pagadora_trabajador - subtotal_esta_obra)
                  - subtotal (sueldo base * asistencias + horas extra * costo_he)
                  - diversos:
                     - *todos los diversos*
                  - total (subtotal + diversos + impuestos)
               - total
  - colaboradores:
      - AFECTAN: app_supervisores, app_obras_prod
      - SUSCRIBEN: app_obras_prod
      - colaborador (por uid):
         - nombre
         - telefono
         - email
         - uid
         - nickname
         - tipo (gerentes o supervisores. La única diferencia es que gerentes tiene obra vacío)
         - obras:
            - obra (por nombre)
               - nombre
               - activa: bool
   - destajistas: 
      - AFECTAN: app_destajistas
      - SUSCRIBEN:
      - destajista: (por nombre)
         - nombre
         - year:
            - semana: 
               - ?
  - obras: 
      - AFECTAN: app_obras_prod app_procesos
      - SUSCRIBEN: app_procesos app_asistencia app_desplegar_procesos app_kaizen_global
      - obra: (por nombre)
         - nombre
         - supervisor
            - supervisor (por uid)
               - nombre: 
               - activo: bool
         - clave
         - PPR: ($)(Personal de producción de reserva)
         - terminado 
         - procesos: Todo lo mismo que en magico menos kaizen (tambien con subprocesos, esos igual todo menos kaizen)
         - fechas:
            - fecha_inicio_real
            - fecha_inicio_teorica
            - fecha_final_real
            - fecha_final_teorica
- clientes
- proyectos
- info_web
- compras
   - colaboradores
      - same shit
   - proveedores
      - Por definir
   - obras
      - obra: (por nombre)
      - nombre
      - cliente
      - clave
      - num_procesos
      - OdeC:
         - year (por num)
            - semana (por num)
               - OdeC (por clave)
                  - clave
                  - precio_ppto
                  - precio_pag
                  - pagada: bool
                  - proveedor
                  - timestamps:
                     - OdeC
                     - registro_OdeC
                     - pago
                     - registro_pago
      - procesos:
         - proceso (por clave):
            - OdeC
               - Igual
            - nombre
            - alcance
            - clave
            - num_subprocesos
            - subprocesos:
               - subproceso (por clave):
                  - OdeC
                     - Igual
                  - nombre
                  - alcance
                  - clave
                  
- kaizen: (Mayúsculas en caso de que haga falta llenarlas desde un excel)
  - PROYECTOS:
     - PPTO -> Admin/prod
     - PAG -> SCORE (yo)
  - PRODUCCION:
     - SUMINISTROS:
        - CUANT -> Proyectos
        - OdeC -> Compras
        - PAG -> Compras
     - COPEO:
        - PREC -> supervisor
        - COPEO -> supervisor
        - PAG -> rrhh
  - ADMINISTRACION:
     - ESTIMACIONES:
        - PPTO -> admin
        - EST -> admin
        - PAG -> admin
     - ANTICIPOS:
        - PPTO -> admin
        - PAG -> admin
  - PROFIT:
     - PROG:
        - BRUTO -> NADIEEEEE
        - NETO -> NADIEEEEE
     - REAL:
        - BRUTO -> NADIEEEEE
        - NETO -> NADIEEEEE
  
  - Para calcular AVANCE (no sale en nuestra bd pero se puede calcular al displayearla):
      - PAG = prod.copeo.pag / prod.copeo.copeo
      - REAL = admin.est.est / admin.est.ppto

  - Para calcular el PROFIT PROG
      - (admin.est.ppto + admin.ants.ppto)*0.8 - prod.copeo.(copeo||prec) - prod.sum.(cuant||OdeC) - proy.ppto
